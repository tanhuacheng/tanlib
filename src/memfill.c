/*
*********************************************************************************************************
* 文件: memfill.c
* 版本: V0.01
* 创建: Wed May 25 23:05:32 2016
* 作者: 谭化成
* 描述: 使用内存块填充内存区域
*********************************************************************************************************
*/

/* 包含头文件 -----------------------------------------------------------------------------------------*/
#include <string.h>
#include "memfill.h"

/* 私有宏定义 -----------------------------------------------------------------------------------------*/
#define MIN(x, y) ((x) < (y) ? (x) : (y))

/* 私有数据类型声明 -----------------------------------------------------------------------------------*/

/* 私有全局变量定义 -----------------------------------------------------------------------------------*/

/* 私有函数声明 ---------------------------------------------------------------------------------------*/

/* 函数定义 -------------------------------------------------------------------------------------------*/
void* memfill (void* restrict dstp, size_t dstsize, const void* restrict patp, size_t patsize)
{
    size_t copy, indx;

    if ((NULL == dstp) || (NULL == patp)) {
        return dstp;
    }

    copy = MIN(dstsize, patsize);
    memcpy(dstp, patp, copy);

    indx = copy;
    while (indx < dstsize) {
        copy = MIN(indx, dstsize - indx);
        memcpy(dstp + indx, dstp, copy);
        indx += copy;
    }

    return dstp;
}

/********************************************* end of file *********************************************/

